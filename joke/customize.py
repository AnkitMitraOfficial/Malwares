import os
import subprocess
import ctypes
from playsound import playsound
import rotatescreen
import time

screen = rotatescreen.get_primary_display()

# Open notepad
appname = 'Notepad.exe'
filename = r'joke\hack.txt'

subprocess.Popen([appname, filename])

# Wallpaper change
SPI_WALLPAPER = 0x14
SPIF_UPDATINGFILE = 0x2 # Instantly updates the file

sourc = r"joke\hack.jpg"
ctypes.windll.user32.SystemParametersInfoW(SPI_WALLPAPER,0,sourc,SPIF_UPDATINGFILE)

# Play Music 
scary_music = r'joke\The_Ghost - Niviro-[AudioTrimmer.com].mp3'

playsound(scary_music)

# Rotates screen
for rotates in range(17): #Why 17 becuase the screen is divided into 4 parts and the screen will only rotate in 4 part, remember 17 is excluded and 16 is counted!
    time.sleep(1)
    screen.rotate_to(rotates * 90 % 360)

appname2 = 'Notepad.exe'
filename2 = r'joke/fun.txt'

subprocess.Popen([appname2, filename2])

# Restart
time.sleep(20)
os.system("shutdown /r /t 1")