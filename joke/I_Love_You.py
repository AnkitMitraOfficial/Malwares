import os # For Shutdown
import subprocess # To open notepad
import ctypes # Wallpaper change
from playsound import playsound # Play background music
import rotatescreen # Rotate the screen
import time # for time breaks
import pywhatkit # To make searches 


screen = rotatescreen.get_primary_display()

print("ONLY ENTER - 'YES' or 'NO'")
choice = input('DO YOU LOVE ME?: ')

if choice == 'YES':
    cool_appname = 'Notepad.exe'
    cool_filename = r'joke\love.txt'
    print('love you too')

    subprocess.Popen([cool_appname, cool_filename])
elif choice == 'NO':
    print('You have not done right!')
    # Open notepad
    appname = 'Notepad.exe'
    filename = r'joke\hack.txt'

    subprocess.Popen([appname, filename])

    # Wallpaper change
    SPI_WALLPAPER = 0x14
    SPIF_UPDATINGFILE = 0x2 # Instantly updates the file
    time.sleep(5)
    pywhatkit.search('virus in my pc')

    sourc = r"joke\hack.jpg"
    ctypes.windll.user32.SystemParametersInfoW(SPI_WALLPAPER,0,sourc,SPIF_UPDATINGFILE)
    time.sleep(7)
    pywhatkit.search('virus download')
    # Play Music 
    scary_music = r'joke\The_Ghost - Niviro-[AudioTrimmer.com].mp3'

    playsound(scary_music)
    die_appname = 'Notepad.exe'
    die_filename = r'joke/die.txt'

    subprocess.Popen([die_appname, die_filename])

    time.sleep(10)
    # Rotates screen
    for rotates in range(17): #Why 17 becuase the screen is divided into 4 parts and the screen will only rotate in 4 part, remember 17 is excluded and 16 is counted!
        time.sleep(1)
        screen.rotate_to(rotates * 90 % 360)

    time.sleep(3)
    appname2 = 'Notepad.exe'
    filename2 = r'joke/fun.txt'

    subprocess.Popen([appname2, filename2])

    # Restart
    time.sleep(20)
    os.system("shutdown /r /t 1")

else:
    print("Don't you understand -- 'YES' or 'NO'")
